
id: FDX-API-Security-Tests

info:
  name: FDX API Security Tests
  author: vtobi
  severity: critical
  description: |
    FDX API Security Tests.
  reference:
    - https://www.financialdataexchange.org/FDX/FDX/News/Press-Releases/Financial_Data_Exchange_Releases_FDX_API_5.0.aspx
  tags: fdx

variables:
  accountIds: "value"
  startTime: "{{base64('hello')}}"
  endTime:
  offset:
  limit:
  
requests:
  - raw:
      - |
        GET /fdx/v4/accounts?accountIds={{accountIds}}&startTime={{startTime}}&endTime={{endTime}}&resultType=lightweight&offset={{offset}}&limit={{limit}}" HTTP/1.1
        Host: {{Hostname}}
        Connection: keep-alive
        
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        part: header
        status:
          - 200
